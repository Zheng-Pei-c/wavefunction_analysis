

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wavefunction_analysis.spins package &mdash; wavefunction_analysis  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="wavefunction_analysis.utils package" href="wavefunction_analysis.utils.html" />
    <link rel="prev" title="wavefunction_analysis.property package" href="wavefunction_analysis.property.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            wavefunction_analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="wavefunction_analysis.html">wavefunction_analysis package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.dynamics.html">wavefunction_analysis.dynamics package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.embedding.html">wavefunction_analysis.embedding package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.opt.html">wavefunction_analysis.opt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.plot.html">wavefunction_analysis.plot package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.polariton.html">wavefunction_analysis.polariton package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.property.html">wavefunction_analysis.property package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">wavefunction_analysis.spins package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.circuit">wavefunction_analysis.spins.circuit module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.circuit.beta_layer"><code class="docutils literal notranslate"><span class="pre">beta_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.circuit.create_circuit"><code class="docutils literal notranslate"><span class="pre">create_circuit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.circuit.create_qubits_2d"><code class="docutils literal notranslate"><span class="pre">create_qubits_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.circuit.gamma_layer"><code class="docutils literal notranslate"><span class="pre">gamma_layer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.infinite_mps_block">wavefunction_analysis.spins.infinite_mps_block module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.apply_gate_on_mps"><code class="docutils literal notranslate"><span class="pre">apply_gate_on_mps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.build_evolution_gate"><code class="docutils literal notranslate"><span class="pre">build_evolution_gate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_left"><code class="docutils literal notranslate"><span class="pre">contract_from_left()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_right"><code class="docutils literal notranslate"><span class="pre">contract_from_right()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_mps"><code class="docutils literal notranslate"><span class="pre">evaluate_energy_mps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_rdm"><code class="docutils literal notranslate"><span class="pre">evaluate_energy_rdm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.get_mps_2rdm"><code class="docutils literal notranslate"><span class="pre">get_mps_2rdm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps"><code class="docutils literal notranslate"><span class="pre">normalize_mps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps_2"><code class="docutils literal notranslate"><span class="pre">normalize_mps_2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.run_tebd"><code class="docutils literal notranslate"><span class="pre">run_tebd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.update_ortho_mps"><code class="docutils literal notranslate"><span class="pre">update_ortho_mps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.matrix_product_state">wavefunction_analysis.spins.matrix_product_state module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_opt_gs"><code class="docutils literal notranslate"><span class="pre">dmrg_opt_gs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_sweep"><code class="docutils literal notranslate"><span class="pre">dmrg_sweep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.get_hamil_from_mpo"><code class="docutils literal notranslate"><span class="pre">get_hamil_from_mpo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_disordered"><code class="docutils literal notranslate"><span class="pre">mpo_hamil_disordered()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_uniform"><code class="docutils literal notranslate"><span class="pre">mpo_hamil_uniform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mpo_spin_correlation"><code class="docutils literal notranslate"><span class="pre">mpo_spin_correlation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical"><code class="docutils literal notranslate"><span class="pre">mps_canonical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_left"><code class="docutils literal notranslate"><span class="pre">mps_canonical_left()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_right"><code class="docutils literal notranslate"><span class="pre">mps_canonical_right()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_left"><code class="docutils literal notranslate"><span class="pre">zipper_from_left()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_right"><code class="docutils literal notranslate"><span class="pre">zipper_from_right()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.qaoa">wavefunction_analysis.spins.qaoa module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.qaoa.QAOA"><code class="docutils literal notranslate"><span class="pre">QAOA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.qaoa.QAOA_Ising"><code class="docutils literal notranslate"><span class="pre">QAOA_Ising</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.spin_hamil">wavefunction_analysis.spins.spin_hamil module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_prod_spin_list"><code class="docutils literal notranslate"><span class="pre">get_prod_spin_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_spin"><code class="docutils literal notranslate"><span class="pre">get_spin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_spin_mat"><code class="docutils literal notranslate"><span class="pre">get_spin_mat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_spins"><code class="docutils literal notranslate"><span class="pre">get_spins()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_heisenberg_1d"><code class="docutils literal notranslate"><span class="pre">hamil_heisenberg_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_x_1d"><code class="docutils literal notranslate"><span class="pre">hamil_x_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_xxz_1d"><code class="docutils literal notranslate"><span class="pre">hamil_xxz_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_xyz_1d"><code class="docutils literal notranslate"><span class="pre">hamil_xyz_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_zeeman_1d"><code class="docutils literal notranslate"><span class="pre">hamil_zeeman_1d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.utils.html">wavefunction_analysis.utils package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wavefunction_analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="wavefunction_analysis.html">wavefunction_analysis package</a></li>
      <li class="breadcrumb-item active">wavefunction_analysis.spins package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Zheng-Pei-c/wavefunction_analysis/edit/main/docs/wavefunction_analysis.spins.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wavefunction-analysis-spins-package">
<h1>wavefunction_analysis.spins package<a class="headerlink" href="#wavefunction-analysis-spins-package" title="Link to this heading">ïƒ</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">ïƒ</a></h2>
</section>
<section id="module-wavefunction_analysis.spins.circuit">
<span id="wavefunction-analysis-spins-circuit-module"></span><h2>wavefunction_analysis.spins.circuit module<a class="headerlink" href="#module-wavefunction_analysis.spins.circuit" title="Link to this heading">ïƒ</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.circuit.beta_layer">
<span class="sig-name descname"><span class="pre">beta_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/circuit.html#beta_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.circuit.beta_layer" title="Link to this definition">ïƒ</a></dt>
<dd><p>Define the beta layer of the circuit.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.circuit.create_circuit">
<span class="sig-name descname"><span class="pre">create_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/circuit.html#create_circuit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.circuit.create_circuit" title="Link to this definition">ïƒ</a></dt>
<dd><p>Create a quantum circuit with Hadamard gates on each qubit for
equal superposition as real initial state.
gamma: ğ›¾ symbol holder as a parameter for U(gamma, C) operator
beta: ÃŸ symbol holder as a parameter for U(beta, B) operator
h: 2D array of magnetic field values
return: cirq.Circuit object</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.circuit.create_qubits_2d">
<span class="sig-name descname"><span class="pre">create_qubits_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nrow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/circuit.html#create_qubits_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.circuit.create_qubits_2d" title="Link to this definition">ïƒ</a></dt>
<dd><p>Initialize qubits in a 2D grid.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.circuit.gamma_layer">
<span class="sig-name descname"><span class="pre">gamma_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/circuit.html#gamma_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.circuit.gamma_layer" title="Link to this definition">ïƒ</a></dt>
<dd><p>Define the gamma layer of the circuit.</p>
</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins.infinite_mps_block">
<span id="wavefunction-analysis-spins-infinite-mps-block-module"></span><h2>wavefunction_analysis.spins.infinite_mps_block module<a class="headerlink" href="#module-wavefunction_analysis.spins.infinite_mps_block" title="Link to this heading">ïƒ</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.apply_gate_on_mps">
<span class="sig-name descname"><span class="pre">apply_gate_on_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gate_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#apply_gate_on_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.apply_gate_on_mps" title="Link to this definition">ïƒ</a></dt>
<dd><p>apply a gate from left to AB dimer MPSs (bra side) for time evolution
use conjugate of evolution operator for the bra state
gate_ab: e^{1j*t*ham_ab} for real-time or e^{-tau*ham_ab} for imaginary-time</p>
<blockquote>
<div><dl>
<dt>â€”1â€”ss_{BA}â€”1â€”Aâ€”3â€”s_{AB}â€”3â€”Bâ€”5â€”ss_{BA}â€”5â€”</dt><dd><blockquote>
<div><div class="line-block">
<div class="line"><a href="#id1"><span class="problematic" id="id2">|</span></a></div>
</div>
<dl>
<dt>2â€”â€”-\  /â€”â€”â€“4</dt><dd><div class="line-block">
<div class="line"><a href="#id3"><span class="problematic" id="id4">|</span></a></div>
</div>
</dd>
</dl>
</div></blockquote>
<p>â€”â€“6â€”â€“U_{AB}â€”â€“7â€”â€“</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>above contraction gives a matrix whose indices in order 1675,</dt><dd><p>first and last are weight dimensions,
while the middle two are the physical dimensions</p>
</dd>
</dl>
<p>subjected to svd to form new MPSs and weights s_ab
gate_ba: switch A and B indices when calling this function</p>
<blockquote>
<div><p>so that update MPSs and s_ba</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.build_evolution_gate">
<span class="sig-name descname"><span class="pre">build_evolution_gate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ham</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'imag'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#build_evolution_gate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.build_evolution_gate" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.contract_from_left">
<span class="sig-name descname"><span class="pre">contract_from_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LM'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#contract_from_left"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_left" title="Link to this definition">ïƒ</a></dt>
<dd><dl class="simple">
<dt>update the environment density matrix at left by contracting it</dt><dd><p>with one more 2-sites (A and B) unit cell</p>
</dd>
<dt>mu_ba: density matrix from the left connects A site via s_ba bond,</dt><dd><p>bottom-up indexed</p>
</dd>
</dl>
<p>mu_ab: also obtained from updated mu_ba and A site
s_ab:  weight vector connects site A (left) to B (right)
s_ba:  weight vector connects site B (left) to A (right)
mps_a: MPS state at site A, bra at top
mps_b: MPS state at site B, bra at top</p>
<blockquote>
<div><blockquote>
<div><p>/â€”â€“2â€”s_{BA}â€”4â€”Atâ€”7â€”s_{AB}â€”-9â€”Btâ€”12â€”
|                      |                      |</p>
</div></blockquote>
<dl>
<dt>mu_{BA}                  5                      10</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                      |</div>
</div>
</div></blockquote>
<p>\â€”â€“1â€”s_{BA}â€”6â€”Abâ€”3â€”s_{AB}â€”11â€”Bbâ€”-8â€”</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>it is equivalent to</dt><dd><blockquote>
<div><p>/â€”â€“2â€”s_{BA}â€”4â€”Aâ€”-7â€”s_{AB}â€”9â€”Bâ€”-12â€”
|                      |                     |</p>
</div></blockquote>
<dl>
<dt>mu_{BA}                  5                     10</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                     |</div>
</div>
</div></blockquote>
<p>\â€”â€“1â€”s_{BA}â€”3â€”A*â€”6â€”s_{AB}â€”8â€”B*â€”11â€”</p>
</dd>
</dl>
</dd>
<dt>we use the following summation as weigths are vectors (or diagonal)</dt><dd><blockquote>
<div><p>/â€”â€“2-jâ€“s_{BA}â€”jâ€”Aâ€”5-mâ€”s_{AB}â€”mâ€”Bâ€”-8-pâ€”
|                       |                      |</p>
</div></blockquote>
<dl>
<dt>mu_{BA}                   3-k                    6-n</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                      |</div>
</div>
</div></blockquote>
<p>\â€”â€“1-iâ€“s_{BA}â€”iâ€”A*â€“4-lâ€”s_{AB}â€”lâ€”B*â€”7-oâ€”</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.contract_from_right">
<span class="sig-name descname"><span class="pre">contract_from_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LM'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#contract_from_right"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_right" title="Link to this definition">ïƒ</a></dt>
<dd><dl class="simple">
<dt>update the environment density matrix at right by contracting it</dt><dd><p>with one more 2-sites (A and B) unit cell</p>
</dd>
<dt>nu_ab: density matrix from the right connects A site via s_ab bond,</dt><dd><p>top-down indexed</p>
</dd>
</dl>
<p>nu_ba: also obtained from B site and updated nu_ab
s_ab:  weight vector connects site A (left) to B (right)
s_ba:  weight vector connects site B (left) to A (right)
mps_a: MPS state at site A, bra at top
mps_b: MPS state at site B, bra at top</p>
<blockquote>
<div><dl>
<dt>â€”-8â€”Btâ€”11â€”s_{BA}â€”3â€”Atâ€”6â€”s_{AB}â€”1â€”-\</dt><dd><div class="line-block">
<div class="line">|                       |</div>
</div>
<p>10                     5                    nu_{AB}
|                      |                       |</p>
</dd>
</dl>
<p>â€”12â€”Bbâ€”-9â€”s_{BA}â€”7â€”Abâ€”4â€”s_{AB}â€”2â€”â€“/</p>
</div></blockquote>
<dl>
<dt>it is equivalent to</dt><dd><dl>
<dt>â€”11â€”BTâ€”-8â€”s_{BA}â€”6â€”ATâ€”-3â€”s_{AB}â€”1â€”-\</dt><dd><div class="line-block">
<div class="line">|                        |</div>
</div>
<p>10                     5                     nu_{AB}
|                      |                        |</p>
</dd>
</dl>
<p>â€”12â€”B*Tâ€”9â€”s_{BA}â€”7â€”A*Tâ€”4â€”s_{AB}â€”2â€”â€“/</p>
</dd>
<dt>we use the following summation as weigths are vectors (or diagonal)</dt><dd><dl>
<dt>â€”o-7â€”Atâ€”lâ€”s_{BA}â€”l-4â€”Atâ€”iâ€”s_{AB}â€”i-1â€”-\</dt><dd><div class="line-block">
<div class="line">|                         |</div>
</div>
<p>6-n                     3-k                     nu_{AB}
|                       |                         |</p>
</dd>
</dl>
<p>â€”p-8â€”Abâ€”mâ€”s_{BA}â€”m-5â€”Abâ€”jâ€”s_{AB}â€”j-2â€”â€“/</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_mps">
<span class="sig-name descname"><span class="pre">evaluate_energy_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpo_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#evaluate_energy_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_mps" title="Link to this definition">ïƒ</a></dt>
<dd><p>get energy of the two sites A and B
use MPS and weights directly rather than build four-index density matrices
E_AB:</p>
<blockquote>
<div><blockquote>
<div><p>/â€”1â€”s_{BA}â€”1â€”Aâ€”-4-lâ€”s_{AB}â€”4â€”Bâ€”-8â€”s_{BA}â€”8â€”\
|                    |                       |                     |
|                   2-jâ€”â€”â€“\   /â€”â€”â€“6-n                    |
|                              |   |                               |
1-i                            H_{AB}                             8-p
|                              |   |                               |
|                   3-kâ€”â€”â€“/  \â€”â€”â€“7-o                    |
|                    |                       |                     |</p>
</div></blockquote>
<p>\â€”1â€”s_{BA}â€”1â€”A*â€”5-mâ€”s_{AB}â€”5â€”B*â€”8â€”s_{BA}â€”8â€”/</p>
</div></blockquote>
<p>E_BA: switch A and B</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_rdm">
<span class="sig-name descname"><span class="pre">evaluate_energy_rdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpo_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_ba</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#evaluate_energy_rdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_rdm" title="Link to this definition">ïƒ</a></dt>
<dd><p>use the density matrix from get_mps_2rdm function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.get_mps_2rdm">
<span class="sig-name descname"><span class="pre">get_mps_2rdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#get_mps_2rdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.get_mps_2rdm" title="Link to this definition">ïƒ</a></dt>
<dd><p>calculate the density matrix of the two-sites in a unit cell
MPS is assumed in canoncial form (orthonormal)
rho: ketbra{ket}{bra} = ketbra{Mb}{Mt} = ketbra{26}{37}
rho_AB:</p>
<blockquote>
<div><blockquote>
<div><p>2-j                     6-n
|                       |</p>
</div></blockquote>
<p>/â€”1â€”s_{BA}â€”1â€”A*â€”4-lâ€”s_{AB}â€”4â€”B*â€”8â€”s_{BA}â€”8â€”|                                                                  |
1-i                                                                8-p
|                                                                  |
/â€”1â€”s_{BA}â€”1â€”Aâ€”-5-mâ€”s_{AB}â€”5â€”Bâ€”-8â€”s_{BA}â€”8â€”/</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a href="#id5"><span class="problematic" id="id6">|</span></a></div>
</div>
<p>3-k                     7-o</p>
</div></blockquote>
</div></blockquote>
<p>rho_BA: switch A and B when calling the function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.normalize_mps">
<span class="sig-name descname"><span class="pre">normalize_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#normalize_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps" title="Link to this definition">ïƒ</a></dt>
<dd><dl>
<dt>normalize the MPS at A or B site</dt><dd><blockquote>
<div><p>/â€”1â€”s_{BA}â€”2â€”Atâ€”5â€”s_{AB}â€”7â€“\
|                    |                     |
1                    4                     7
|                    |                     |</p>
</div></blockquote>
<dl class="simple">
<dt>\â€”1â€”s_{BA}â€”6â€”Abâ€”3â€”s_{AB}â€”7â€”/</dt><dd><p>since weight vectors are diagonal, it reduces to
/â€”1â€”s_{BA}â€”1â€”Aâ€”-3â€”s_{AB}â€”3â€“\
|                    |                     |
1                    2                     3
|                    |                     |</p>
</dd>
</dl>
<p>\â€”1â€”s_{BA}â€”1â€”A*â€”3â€”s_{AB}â€”3â€”/</p>
</dd>
</dl>
<p>s_left and s_right are switched for site B</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.normalize_mps_2">
<span class="sig-name descname"><span class="pre">normalize_mps_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#normalize_mps_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps_2" title="Link to this definition">ïƒ</a></dt>
<dd><p>normalize mps_a and mps_b at same time
same functionality as the previous normalize_mps()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.run_tebd">
<span class="sig-name descname"><span class="pre">run_tebd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ham_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ham_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_ba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu_ab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'imag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">midstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#run_tebd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.run_tebd" title="Link to this definition">ïƒ</a></dt>
<dd><p>run time evolving block decimation based on MPS of infinite two-site unit cells
refer: <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.93.040502">https://doi.org/10.1103/PhysRevLett.93.040502</a></p>
<blockquote>
<div><p><a class="reference external" href="https://www.tensors.net/mps">https://www.tensors.net/mps</a></p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.update_ortho_mps">
<span class="sig-name descname"><span class="pre">update_ortho_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#update_ortho_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.update_ortho_mps" title="Link to this definition">ïƒ</a></dt>
<dd><p>set the dimer AB or BA linker to cononical form
update the weight connecting A and B sites and the MPSs
the left and right rho and weight should have same order:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>mu_ab, nu_ab, s_ab; or mu_ba, nu_ba, s_ba</p>
</div></blockquote>
<p>/â€”â€“s_{AB}â€”-\                    /â€”â€“s_{BA}â€”-\
|                |                    |                |</p>
</div></blockquote>
<dl>
<dt>mu_{AB}^T        nu_{AB}      or      mu_{BA}          nu_{BA}^T</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                    |                |</div>
</div>
</div></blockquote>
<p>\â€”â€“s_{AB}â€”â€“/                   \â€”â€“s_{BA}â€”â€“/</p>
<blockquote>
<div><p>/â€”4-lâ€”s_{AB}â€”l-4â€“\
|                        |</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>â€”1-iâ€”Atâ€”3-kâ€” mu_{AB}                  nu_{AB}â€”5-mâ€”Btâ€”7-oâ€”</dt><dd><div class="line-block">
<div class="line"><a href="#id7"><span class="problematic" id="id8">|</span></a></div>
</div>
<p>2-j                                                    6-n
|                                                      |</p>
</dd>
</dl>
<p>left rho is bottom-up indexed while right rho is top-down indexed
first step: orthogonalize density matrices and form new weight
second step: svd of new weight and construct new MPSs
A * mu * s * nu * B = A * l_U * (l_e * l_U^T * s * r_U * r_e) * r_U^T * B</p>
<blockquote>
<div><p>= (A * l_U /l_e * U_s) * tilde{s} * (Vt_s /r_e * r_U^T * B)</p>
</div></blockquote>
<p>the third dimension of A and first dimension of B might be reduced</p>
</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins.matrix_product_state">
<span id="wavefunction-analysis-spins-matrix-product-state-module"></span><h2>wavefunction_analysis.spins.matrix_product_state module<a class="headerlink" href="#module-wavefunction_analysis.spins.matrix_product_state" title="Link to this heading">ïƒ</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.dmrg_opt_gs">
<span class="sig-name descname"><span class="pre">dmrg_opt_gs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_mpo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tzip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#dmrg_opt_gs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_opt_gs" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.dmrg_sweep">
<span class="sig-name descname"><span class="pre">dmrg_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_mpo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tzip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#dmrg_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_sweep" title="Link to this definition">ïƒ</a></dt>
<dd><p>Tzip is given as the right zipper with indecies ordering from top to bottom
at every site so that we continue in this function</p>
<blockquote>
<div><blockquote>
<div><p>1). sweep from left to right first
2). and then from right to left
3). return the right zipper in the end</p>
</div></blockquote>
<div class="line-block">
<div class="line">|             |</div>
</div>
<p>3-l           3-m           1-n
|             |             |
Tâ€”2-<em>p</em>-1â€”Oâ€”2-<em>q</em>-2â€”T
|             |             |
1-i           4-j           3-k
|             |             |</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.get_hamil_from_mpo">
<span class="sig-name descname"><span class="pre">get_hamil_from_mpo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_mpo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#get_hamil_from_mpo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.get_hamil_from_mpo" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mpo_hamil_disordered">
<span class="sig-name descname"><span class="pre">mpo_hamil_disordered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mpo_hamil_disordered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_disordered" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mpo_hamil_uniform">
<span class="sig-name descname"><span class="pre">mpo_hamil_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mpo_hamil_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_uniform" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mpo_spin_correlation">
<span class="sig-name descname"><span class="pre">mpo_spin_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mpo_spin_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mpo_spin_correlation" title="Link to this definition">ïƒ</a></dt>
<dd><p>expval{sigma_{l}^{+} sigma_{l+1}^{-}}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mps_canonical">
<span class="sig-name descname"><span class="pre">mps_canonical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mps_canonical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical" title="Link to this definition">ïƒ</a></dt>
<dd><p>random bra MPS wavefunction matries at top
order of legs: left-bottom-right
ket MPS at bottom is the transpose with legs in right-top-left order
â€”1â€”Mtâ€”3â€”                  |</p>
<blockquote>
<div><div class="line-block">
<div class="line">2</div>
</div>
<p>2                          |
|                   â€”3â€”Mbâ€”1â€”</p>
</div></blockquote>
<p>the left and right legs are virtual bounds to be contracted to adjacent MPS
the bottom or top legs are physical bounds (spins) to be contracted to MPO
ndims: an array of leg dimensions [nd,ns,nd] in the order [left, bottom, right]</p>
<blockquote>
<div><p>such that the first and third numbers should be same</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mps_canonical_left">
<span class="sig-name descname"><span class="pre">mps_canonical_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mps_canonical_left"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_left" title="Link to this definition">ïƒ</a></dt>
<dd><p>normalize MPS matrices from the left
treat the first two dimensions as a vector to reduce the right leg numbers
M1 * M2 = U*s*V^T * M2 = U * (s*V^T*M2)
such that M1 is replaced by a smaller U</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mps_canonical_right">
<span class="sig-name descname"><span class="pre">mps_canonical_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mps_canonical_right"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_right" title="Link to this definition">ïƒ</a></dt>
<dd><p>normalize MPS matrices from the right
treat the last two dimensions as a vector to reduce the left leg numbers
M1 * M2 = M1 * U*s*V^T = (M1*U*s) * V^T
such that M2 is replaced by a smaller V^T</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.zipper_from_left">
<span class="sig-name descname"><span class="pre">zipper_from_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[[1.]]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#zipper_from_left"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_left" title="Link to this definition">ïƒ</a></dt>
<dd><blockquote>
<div><p>Tl legs order from bottom to top, default np.ones((1,1,1)) for boundary site
Contract Tl from the left with 1). bra Mt at top,</p>
<blockquote>
<div><p>2). operator O at middle,
3). ket Mt at bottom.</p>
</div></blockquote>
<p>/â€”3â€”<em>q</em>â€”1â€”Mtâ€”3-kâ€“
|                 |
|                 2
|                 |
|                 <em>l
|                 |
|                 3              /â€”3-kâ€“
|                 |              |
Tlâ€“2â€”*p</em>â€”1â€”Oâ€”-2-jâ€“ =   Tfâ€“2-jâ€“
|                 |              |
|                 4             \â€”1-iâ€“
|                 |
|                 <a href="#id9"><span class="problematic" id="id10">*</span></a>m
|                 |
|                 2
|                 |</p>
</div></blockquote>
<p>\â€”1â€”<em>n</em>â€”3â€”Mbâ€”1-iâ€”</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.zipper_from_right">
<span class="sig-name descname"><span class="pre">zipper_from_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[[1.]]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#zipper_from_right"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_right" title="Link to this definition">ïƒ</a></dt>
<dd><p>Tr legs order from top to bottom, default np.ones((1,1,1)) for boundary site
Contract Tl from the right with 1). bra Mt at top,</p>
<blockquote>
<div><p>2). operator O at middle,
3). ket Mt at bottom.</p>
</div></blockquote>
<dl>
<dt>â€“i-1â€”Mtâ€”3â€”<em>q</em>â€”1â€“\</dt><dd><div class="line-block">
<div class="line"><a href="#id11"><span class="problematic" id="id12">|</span></a></div>
</div>
<p>2                  |
|                  |
<a href="#id13"><span class="problematic" id="id14">*</span></a>l                 |
|                  |
3                  |      â€“1-i-\
|                  |             |</p>
</dd>
<dt>â€“j-1â€”Oâ€”-2â€”<em>p</em>â€”2â€”Tr =   â€“2-jâ€“Tf</dt><dd><div class="line-block">
<div class="line">|             |</div>
</div>
<p>4                  |      â€“3-kâ€“/
|                  |
<a href="#id15"><span class="problematic" id="id16">*</span></a>m                 |
|                  |
2                  |
|                  |</p>
</dd>
</dl>
<p>â€“k-3â€”Mbâ€”1â€”<em>n</em>â€”3â€”/</p>
</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins.qaoa">
<span id="wavefunction-analysis-spins-qaoa-module"></span><h2>wavefunction_analysis.spins.qaoa module<a class="headerlink" href="#module-wavefunction_analysis.spins.qaoa" title="Link to this heading">ïƒ</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QAOA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA" title="Link to this definition">ïƒ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Quantum Approximate Optimization Algorithm class.</p>
<dl class="py property">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA.draw_circuit">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_circuit</span></span><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA.draw_circuit" title="Link to this definition">ïƒ</a></dt>
<dd><p>Draw the quantum circuit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA.energy_evaluation">
<span class="sig-name descname"><span class="pre">energy_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA.energy_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA.energy_evaluation" title="Link to this definition">ïƒ</a></dt>
<dd><p>Evaluate the energy expectation value for given gamma and beta on circuit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA.energy_expectation">
<span class="sig-name descname"><span class="pre">energy_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA.energy_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA.energy_expectation" title="Link to this definition">ïƒ</a></dt>
<dd><p>Calculate the energy expectation value for a given wavefunction.
wf: wavefunction is an array of size 2**(nrow*ncol)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA.fd_gradient_evaluation">
<span class="sig-name descname"><span class="pre">fd_gradient_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA.fd_gradient_evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA.fd_gradient_evaluation" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA.optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA.optimizer" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA.resolve_circuit_params">
<span class="sig-name descname"><span class="pre">resolve_circuit_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA.resolve_circuit_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA.resolve_circuit_params" title="Link to this definition">ïƒ</a></dt>
<dd><p>Define the circuit parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA_Ising">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QAOA_Ising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA_Ising"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA_Ising" title="Link to this definition">ïƒ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wavefunction_analysis.spins.qaoa.QAOA" title="wavefunction_analysis.spins.qaoa.QAOA"><code class="xref py py-class docutils literal notranslate"><span class="pre">QAOA</span></code></a></p>
<p><cite>E = - sum_{ij} sigma_i sigma_j - h_i sigma_i</cite>
h is the magnetic field on each spin</p>
<dl class="py method">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA_Ising.energy_expectation">
<span class="sig-name descname"><span class="pre">energy_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA_Ising.energy_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA_Ising.energy_expectation" title="Link to this definition">ïƒ</a></dt>
<dd><p>wf: wavefunction is an array of size 2**(nrow*ncol)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.qaoa.QAOA_Ising.resolve_circuit_params">
<span class="sig-name descname"><span class="pre">resolve_circuit_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/qaoa.html#QAOA_Ising.resolve_circuit_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.qaoa.QAOA_Ising.resolve_circuit_params" title="Link to this definition">ïƒ</a></dt>
<dd><p>Define the circuit parameters for Ising model.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins.spin_hamil">
<span id="wavefunction-analysis-spins-spin-hamil-module"></span><h2>wavefunction_analysis.spins.spin_hamil module<a class="headerlink" href="#module-wavefunction_analysis.spins.spin_hamil" title="Link to this heading">ïƒ</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_prod_spin_list">
<span class="sig-name descname"><span class="pre">get_prod_spin_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_prod_spin_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_prod_spin_list" title="Link to this definition">ïƒ</a></dt>
<dd><dl class="simple">
<dt>the actual sigma_{ix} matrix:</dt><dd><p>loop over n spins
set i-th spin with spin matrices while the rest are identity matrices
return n*d supermatrices as Hilbert space operators or basis</p>
</dd>
</dl>
<p>the use of these matrices gives exact Hamiltonian in rather huge dimension</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_spin">
<span class="sig-name descname"><span class="pre">get_spin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_spin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_spin" title="Link to this definition">ïƒ</a></dt>
<dd><p>spin matrices from qutip package</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_spin_mat">
<span class="sig-name descname"><span class="pre">get_spin_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_spin_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_spin_mat" title="Link to this definition">ïƒ</a></dt>
<dd><p>reload get_spin() but return numpy matrix by qutip full() function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_spins">
<span class="sig-name descname"><span class="pre">get_spins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_spins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_spins" title="Link to this definition">ïƒ</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_heisenberg_1d">
<span class="sig-name descname"><span class="pre">hamil_heisenberg_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_heisenberg_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_heisenberg_1d" title="Link to this definition">ïƒ</a></dt>
<dd><p>build xxz 1d-chain spin model hamiltonian H in Hilbert space
H = sum_{i}^{n} ( j_{i,x} * sigma_{i,x} sigma_{i+1,x}</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>j_{i,y} * sigma_{i,y} sigma_{i+1,y}</p></li>
<li><p>j_{i,z} * sigma_{i,z} sigma_{i+1,z})</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>sum_{i}^{n} hz_{i} * sigma_{i,z}</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>note that when j_{x} = j_{y}</dt><dd><p>sigma_x sigma_x + sigma_y sigma_y
= .5 * (sigma_p sigma_m + sigma_m sigma_p)
using ladder operators such that the matrices are real</p>
</dd>
</dl>
<p>n: number of 1/2 spins
j: spin coupling constant of xx, yy, zz sigma
hz: magnetic field strength along z axis for each spin
boundary condition: open or periodic</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_x_1d">
<span class="sig-name descname"><span class="pre">hamil_x_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_x_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_x_1d" title="Link to this definition">ïƒ</a></dt>
<dd><p>separate one direction for efficiency</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_xxz_1d">
<span class="sig-name descname"><span class="pre">hamil_xxz_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_xxz_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_xxz_1d" title="Link to this definition">ïƒ</a></dt>
<dd><p>j * (xx + yy + zz * delta)
reimplement for efficiency using ladder operator by defalut</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_xyz_1d">
<span class="sig-name descname"><span class="pre">hamil_xyz_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_xyz_1d" title="Link to this definition">ïƒ</a></dt>
<dd><p>build xxz 1d-chain spin model hamiltonian H in Hilbert space
H = sum_{i}^{n} ( j_{i,x} * sigma_{i,x} sigma_{i+1,x}</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>j_{i,y} * sigma_{i,y} sigma_{i+1,y}</p></li>
<li><p>j_{i,z} * sigma_{i,z} sigma_{i+1,z})</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>sum_{i}^{n} hz_{i} * sigma_{i,z}</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>note that when j_{x} = j_{y}</dt><dd><p>sigma_x sigma_x + sigma_y sigma_y
= .5 * (sigma_p sigma_m + sigma_m sigma_p)
using ladder operators such that the matrices are real</p>
</dd>
</dl>
<p>n: number of 1/2 spins
j: spin coupling constant of xx, yy, zz sigma
hz: magnetic field strength along z axis for each spin
boundary condition: open or periodic</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_zeeman_1d">
<span class="sig-name descname"><span class="pre">hamil_zeeman_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_zeeman_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_zeeman_1d" title="Link to this definition">ïƒ</a></dt>
<dd><p>separate the magnetic field part for efficiency</p>
</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-wavefunction_analysis.spins" title="Link to this heading">ïƒ</a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="wavefunction_analysis.property.html" class="btn btn-neutral float-left" title="wavefunction_analysis.property package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wavefunction_analysis.utils.html" class="btn btn-neutral float-right" title="wavefunction_analysis.utils package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Zheng Pei.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
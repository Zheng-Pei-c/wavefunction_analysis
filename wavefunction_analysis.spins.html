

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wavefunction_analysis.spins package &mdash; wavefunction_analysis  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="wavefunction_analysis.string_path package" href="wavefunction_analysis.string_path.html" />
    <link rel="prev" title="wavefunction_analysis.quantum_computing package" href="wavefunction_analysis.quantum_computing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            wavefunction_analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="wavefunction_analysis.html">wavefunction_analysis package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.dynamics.html">wavefunction_analysis.dynamics package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.entanglement.html">wavefunction_analysis.entanglement package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.manifold.html">wavefunction_analysis.manifold package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.opt.html">wavefunction_analysis.opt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.plot.html">wavefunction_analysis.plot package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.polariton.html">wavefunction_analysis.polariton package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.property.html">wavefunction_analysis.property package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.quantum_computing.html">wavefunction_analysis.quantum_computing package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">wavefunction_analysis.spins package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.infinite_mps_block">wavefunction_analysis.spins.infinite_mps_block module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.apply_gate_on_mps"><code class="docutils literal notranslate"><span class="pre">apply_gate_on_mps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.build_evolution_gate"><code class="docutils literal notranslate"><span class="pre">build_evolution_gate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_left"><code class="docutils literal notranslate"><span class="pre">contract_from_left()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_right"><code class="docutils literal notranslate"><span class="pre">contract_from_right()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_mps"><code class="docutils literal notranslate"><span class="pre">evaluate_energy_mps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_rdm"><code class="docutils literal notranslate"><span class="pre">evaluate_energy_rdm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.get_mps_2rdm"><code class="docutils literal notranslate"><span class="pre">get_mps_2rdm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps"><code class="docutils literal notranslate"><span class="pre">normalize_mps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps_2"><code class="docutils literal notranslate"><span class="pre">normalize_mps_2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.run_tebd"><code class="docutils literal notranslate"><span class="pre">run_tebd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.infinite_mps_block.update_ortho_mps"><code class="docutils literal notranslate"><span class="pre">update_ortho_mps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.matrix_product_state">wavefunction_analysis.spins.matrix_product_state module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_opt_gs"><code class="docutils literal notranslate"><span class="pre">dmrg_opt_gs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_sweep"><code class="docutils literal notranslate"><span class="pre">dmrg_sweep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.get_hamil_from_mpo"><code class="docutils literal notranslate"><span class="pre">get_hamil_from_mpo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_disordered"><code class="docutils literal notranslate"><span class="pre">mpo_hamil_disordered()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_uniform"><code class="docutils literal notranslate"><span class="pre">mpo_hamil_uniform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mpo_spin_correlation"><code class="docutils literal notranslate"><span class="pre">mpo_spin_correlation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical"><code class="docutils literal notranslate"><span class="pre">mps_canonical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_left"><code class="docutils literal notranslate"><span class="pre">mps_canonical_left()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_right"><code class="docutils literal notranslate"><span class="pre">mps_canonical_right()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_left"><code class="docutils literal notranslate"><span class="pre">zipper_from_left()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_right"><code class="docutils literal notranslate"><span class="pre">zipper_from_right()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins.spin_hamil">wavefunction_analysis.spins.spin_hamil module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_prod_spin_list"><code class="docutils literal notranslate"><span class="pre">get_prod_spin_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_spin"><code class="docutils literal notranslate"><span class="pre">get_spin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_spin_mat"><code class="docutils literal notranslate"><span class="pre">get_spin_mat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.get_spins"><code class="docutils literal notranslate"><span class="pre">get_spins()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_heisenberg_1d"><code class="docutils literal notranslate"><span class="pre">hamil_heisenberg_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_x_1d"><code class="docutils literal notranslate"><span class="pre">hamil_x_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_xxz_1d"><code class="docutils literal notranslate"><span class="pre">hamil_xxz_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_xyz_1d"><code class="docutils literal notranslate"><span class="pre">hamil_xyz_1d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wavefunction_analysis.spins.spin_hamil.hamil_zeeman_1d"><code class="docutils literal notranslate"><span class="pre">hamil_zeeman_1d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-wavefunction_analysis.spins">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.string_path.html">wavefunction_analysis.string_path package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavefunction_analysis.utils.html">wavefunction_analysis.utils package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wavefunction_analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="wavefunction_analysis.html">wavefunction_analysis package</a></li>
      <li class="breadcrumb-item active">wavefunction_analysis.spins package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Zheng-Pei-c/wavefunction_analysis/edit/main/docs/wavefunction_analysis.spins.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wavefunction-analysis-spins-package">
<h1>wavefunction_analysis.spins package<a class="headerlink" href="#wavefunction-analysis-spins-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-wavefunction_analysis.spins.infinite_mps_block">
<span id="wavefunction-analysis-spins-infinite-mps-block-module"></span><h2>wavefunction_analysis.spins.infinite_mps_block module<a class="headerlink" href="#module-wavefunction_analysis.spins.infinite_mps_block" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.apply_gate_on_mps">
<span class="sig-name descname"><span class="pre">apply_gate_on_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gate_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#apply_gate_on_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.apply_gate_on_mps" title="Link to this definition"></a></dt>
<dd><p>apply a gate from left to AB dimer MPSs (bra side) for time evolution
use conjugate of evolution operator for the bra state
gate_ab: e^{1j*t*ham_ab} for real-time or e^{-tau*ham_ab} for imaginary-time</p>
<blockquote>
<div><dl>
<dt>—1—ss_{BA}—1—A—3—s_{AB}—3—B—5—ss_{BA}—5—</dt><dd><blockquote>
<div><div class="line-block">
<div class="line"><a href="#id1"><span class="problematic" id="id2">|</span></a></div>
</div>
<dl>
<dt>2——-\  /——–4</dt><dd><div class="line-block">
<div class="line"><a href="#id3"><span class="problematic" id="id4">|</span></a></div>
</div>
</dd>
</dl>
</div></blockquote>
<p>—–6—–U_{AB}—–7—–</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>above contraction gives a matrix whose indices in order 1675,</dt><dd><p>first and last are weight dimensions,
while the middle two are the physical dimensions</p>
</dd>
</dl>
<p>subjected to svd to form new MPSs and weights s_ab
gate_ba: switch A and B indices when calling this function</p>
<blockquote>
<div><p>so that update MPSs and s_ba</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.build_evolution_gate">
<span class="sig-name descname"><span class="pre">build_evolution_gate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ham</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'imag'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#build_evolution_gate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.build_evolution_gate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.contract_from_left">
<span class="sig-name descname"><span class="pre">contract_from_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LM'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#contract_from_left"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_left" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>update the environment density matrix at left by contracting it</dt><dd><p>with one more 2-sites (A and B) unit cell</p>
</dd>
<dt>mu_ba: density matrix from the left connects A site via s_ba bond,</dt><dd><p>bottom-up indexed</p>
</dd>
</dl>
<p>mu_ab: also obtained from updated mu_ba and A site
s_ab:  weight vector connects site A (left) to B (right)
s_ba:  weight vector connects site B (left) to A (right)
mps_a: MPS state at site A, bra at top
mps_b: MPS state at site B, bra at top</p>
<blockquote>
<div><blockquote>
<div><p>/—–2—s_{BA}—4—At—7—s_{AB}—-9—Bt—12—
|                      |                      |</p>
</div></blockquote>
<dl>
<dt>mu_{BA}                  5                      10</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                      |</div>
</div>
</div></blockquote>
<p>\—–1—s_{BA}—6—Ab—3—s_{AB}—11—Bb—-8—</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>it is equivalent to</dt><dd><blockquote>
<div><p>/—–2—s_{BA}—4—A—-7—s_{AB}—9—B—-12—
|                      |                     |</p>
</div></blockquote>
<dl>
<dt>mu_{BA}                  5                     10</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                     |</div>
</div>
</div></blockquote>
<p>\—–1—s_{BA}—3—A*—6—s_{AB}—8—B*—11—</p>
</dd>
</dl>
</dd>
<dt>we use the following summation as weigths are vectors (or diagonal)</dt><dd><blockquote>
<div><p>/—–2-j–s_{BA}—j—A—5-m—s_{AB}—m—B—-8-p—
|                       |                      |</p>
</div></blockquote>
<dl>
<dt>mu_{BA}                   3-k                    6-n</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                      |</div>
</div>
</div></blockquote>
<p>\—–1-i–s_{BA}—i—A*–4-l—s_{AB}—l—B*—7-o—</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.contract_from_right">
<span class="sig-name descname"><span class="pre">contract_from_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LM'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#contract_from_right"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.contract_from_right" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>update the environment density matrix at right by contracting it</dt><dd><p>with one more 2-sites (A and B) unit cell</p>
</dd>
<dt>nu_ab: density matrix from the right connects A site via s_ab bond,</dt><dd><p>top-down indexed</p>
</dd>
</dl>
<p>nu_ba: also obtained from B site and updated nu_ab
s_ab:  weight vector connects site A (left) to B (right)
s_ba:  weight vector connects site B (left) to A (right)
mps_a: MPS state at site A, bra at top
mps_b: MPS state at site B, bra at top</p>
<blockquote>
<div><dl>
<dt>—-8—Bt—11—s_{BA}—3—At—6—s_{AB}—1—-\</dt><dd><div class="line-block">
<div class="line">|                       |</div>
</div>
<p>10                     5                    nu_{AB}
|                      |                       |</p>
</dd>
</dl>
<p>—12—Bb—-9—s_{BA}—7—Ab—4—s_{AB}—2—–/</p>
</div></blockquote>
<dl>
<dt>it is equivalent to</dt><dd><dl>
<dt>—11—BT—-8—s_{BA}—6—AT—-3—s_{AB}—1—-\</dt><dd><div class="line-block">
<div class="line">|                        |</div>
</div>
<p>10                     5                     nu_{AB}
|                      |                        |</p>
</dd>
</dl>
<p>—12—B*T—9—s_{BA}—7—A*T—4—s_{AB}—2—–/</p>
</dd>
<dt>we use the following summation as weigths are vectors (or diagonal)</dt><dd><dl>
<dt>—o-7—At—l—s_{BA}—l-4—At—i—s_{AB}—i-1—-\</dt><dd><div class="line-block">
<div class="line">|                         |</div>
</div>
<p>6-n                     3-k                     nu_{AB}
|                       |                         |</p>
</dd>
</dl>
<p>—p-8—Ab—m—s_{BA}—m-5—Ab—j—s_{AB}—j-2—–/</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_mps">
<span class="sig-name descname"><span class="pre">evaluate_energy_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpo_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#evaluate_energy_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_mps" title="Link to this definition"></a></dt>
<dd><p>get energy of the two sites A and B
use MPS and weights directly rather than build four-index density matrices
E_AB:</p>
<blockquote>
<div><blockquote>
<div><p>/—1—s_{BA}—1—A—-4-l—s_{AB}—4—B—-8—s_{BA}—8—\
|                    |                       |                     |
|                   2-j——–\   /——–6-n                    |
|                              |   |                               |
1-i                            H_{AB}                             8-p
|                              |   |                               |
|                   3-k——–/  \——–7-o                    |
|                    |                       |                     |</p>
</div></blockquote>
<p>\—1—s_{BA}—1—A*—5-m—s_{AB}—5—B*—8—s_{BA}—8—/</p>
</div></blockquote>
<p>E_BA: switch A and B</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_rdm">
<span class="sig-name descname"><span class="pre">evaluate_energy_rdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpo_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpo_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_ba</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#evaluate_energy_rdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.evaluate_energy_rdm" title="Link to this definition"></a></dt>
<dd><p>use the density matrix from get_mps_2rdm function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.get_mps_2rdm">
<span class="sig-name descname"><span class="pre">get_mps_2rdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#get_mps_2rdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.get_mps_2rdm" title="Link to this definition"></a></dt>
<dd><p>calculate the density matrix of the two-sites in a unit cell
MPS is assumed in canoncial form (orthonormal)
rho: ketbra{ket}{bra} = ketbra{Mb}{Mt} = ketbra{26}{37}
rho_AB:</p>
<blockquote>
<div><blockquote>
<div><p>2-j                     6-n
|                       |</p>
</div></blockquote>
<p>/—1—s_{BA}—1—A*—4-l—s_{AB}—4—B*—8—s_{BA}—8—|                                                                  |
1-i                                                                8-p
|                                                                  |
/—1—s_{BA}—1—A—-5-m—s_{AB}—5—B—-8—s_{BA}—8—/</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a href="#id5"><span class="problematic" id="id6">|</span></a></div>
</div>
<p>3-k                     7-o</p>
</div></blockquote>
</div></blockquote>
<p>rho_BA: switch A and B when calling the function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.normalize_mps">
<span class="sig-name descname"><span class="pre">normalize_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#normalize_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps" title="Link to this definition"></a></dt>
<dd><dl>
<dt>normalize the MPS at A or B site</dt><dd><blockquote>
<div><p>/—1—s_{BA}—2—At—5—s_{AB}—7–\
|                    |                     |
1                    4                     7
|                    |                     |</p>
</div></blockquote>
<dl class="simple">
<dt>\—1—s_{BA}—6—Ab—3—s_{AB}—7—/</dt><dd><p>since weight vectors are diagonal, it reduces to
/—1—s_{BA}—1—A—-3—s_{AB}—3–\
|                    |                     |
1                    2                     3
|                    |                     |</p>
</dd>
</dl>
<p>\—1—s_{BA}—1—A*—3—s_{AB}—3—/</p>
</dd>
</dl>
<p>s_left and s_right are switched for site B</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.normalize_mps_2">
<span class="sig-name descname"><span class="pre">normalize_mps_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#normalize_mps_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.normalize_mps_2" title="Link to this definition"></a></dt>
<dd><p>normalize mps_a and mps_b at same time
same functionality as the previous normalize_mps()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.run_tebd">
<span class="sig-name descname"><span class="pre">run_tebd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ham_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ham_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_ba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu_ab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'imag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">midstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#run_tebd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.run_tebd" title="Link to this definition"></a></dt>
<dd><p>run time evolving block decimation based on MPS of infinite two-site unit cells
refer: <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.93.040502">https://doi.org/10.1103/PhysRevLett.93.040502</a></p>
<blockquote>
<div><p><a class="reference external" href="https://www.tensors.net/mps">https://www.tensors.net/mps</a></p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.infinite_mps_block.update_ortho_mps">
<span class="sig-name descname"><span class="pre">update_ortho_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps_right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/infinite_mps_block.html#update_ortho_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.infinite_mps_block.update_ortho_mps" title="Link to this definition"></a></dt>
<dd><p>set the dimer AB or BA linker to cononical form
update the weight connecting A and B sites and the MPSs
the left and right rho and weight should have same order:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>mu_ab, nu_ab, s_ab; or mu_ba, nu_ba, s_ba</p>
</div></blockquote>
<p>/—–s_{AB}—-\                    /—–s_{BA}—-\
|                |                    |                |</p>
</div></blockquote>
<dl>
<dt>mu_{AB}^T        nu_{AB}      or      mu_{BA}          nu_{BA}^T</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">|                    |                |</div>
</div>
</div></blockquote>
<p>\—–s_{AB}—–/                   \—–s_{BA}—–/</p>
<blockquote>
<div><p>/—4-l—s_{AB}—l-4–\
|                        |</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>—1-i—At—3-k— mu_{AB}                  nu_{AB}—5-m—Bt—7-o—</dt><dd><div class="line-block">
<div class="line"><a href="#id7"><span class="problematic" id="id8">|</span></a></div>
</div>
<p>2-j                                                    6-n
|                                                      |</p>
</dd>
</dl>
<p>left rho is bottom-up indexed while right rho is top-down indexed
first step: orthogonalize density matrices and form new weight
second step: svd of new weight and construct new MPSs
A * mu * s * nu * B = A * l_U * (l_e * l_U^T * s * r_U * r_e) * r_U^T * B</p>
<blockquote>
<div><p>= (A * l_U /l_e * U_s) * tilde{s} * (Vt_s /r_e * r_U^T * B)</p>
</div></blockquote>
<p>the third dimension of A and first dimension of B might be reduced</p>
</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins.matrix_product_state">
<span id="wavefunction-analysis-spins-matrix-product-state-module"></span><h2>wavefunction_analysis.spins.matrix_product_state module<a class="headerlink" href="#module-wavefunction_analysis.spins.matrix_product_state" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.dmrg_opt_gs">
<span class="sig-name descname"><span class="pre">dmrg_opt_gs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_mpo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tzip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#dmrg_opt_gs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_opt_gs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.dmrg_sweep">
<span class="sig-name descname"><span class="pre">dmrg_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_mpo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tzip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#dmrg_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.dmrg_sweep" title="Link to this definition"></a></dt>
<dd><p>Tzip is given as the right zipper with indecies ordering from top to bottom
at every site so that we continue in this function</p>
<blockquote>
<div><blockquote>
<div><p>1). sweep from left to right first
2). and then from right to left
3). return the right zipper in the end</p>
</div></blockquote>
<div class="line-block">
<div class="line">|             |</div>
</div>
<p>3-l           3-m           1-n
|             |             |
T—2-<em>p</em>-1—O—2-<em>q</em>-2—T
|             |             |
1-i           4-j           3-k
|             |             |</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.get_hamil_from_mpo">
<span class="sig-name descname"><span class="pre">get_hamil_from_mpo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_mpo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#get_hamil_from_mpo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.get_hamil_from_mpo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mpo_hamil_disordered">
<span class="sig-name descname"><span class="pre">mpo_hamil_disordered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mpo_hamil_disordered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_disordered" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mpo_hamil_uniform">
<span class="sig-name descname"><span class="pre">mpo_hamil_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mpo_hamil_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mpo_hamil_uniform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mpo_spin_correlation">
<span class="sig-name descname"><span class="pre">mpo_spin_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mpo_spin_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mpo_spin_correlation" title="Link to this definition"></a></dt>
<dd><p>expval{sigma_{l}^{+} sigma_{l+1}^{-}}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mps_canonical">
<span class="sig-name descname"><span class="pre">mps_canonical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mps_canonical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical" title="Link to this definition"></a></dt>
<dd><p>random bra MPS wavefunction matries at top
order of legs: left-bottom-right
ket MPS at bottom is the transpose with legs in right-top-left order
—1—Mt—3—                  |</p>
<blockquote>
<div><div class="line-block">
<div class="line">2</div>
</div>
<p>2                          |
|                   —3—Mb—1—</p>
</div></blockquote>
<p>the left and right legs are virtual bounds to be contracted to adjacent MPS
the bottom or top legs are physical bounds (spins) to be contracted to MPO
ndims: an array of leg dimensions [nd,ns,nd] in the order [left, bottom, right]</p>
<blockquote>
<div><p>such that the first and third numbers should be same</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mps_canonical_left">
<span class="sig-name descname"><span class="pre">mps_canonical_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mps_canonical_left"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_left" title="Link to this definition"></a></dt>
<dd><p>normalize MPS matrices from the left
treat the first two dimensions as a vector to reduce the right leg numbers
M1 * M2 = U*s*V^T * M2 = U * (s*V^T*M2)
such that M1 is replaced by a smaller U</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.mps_canonical_right">
<span class="sig-name descname"><span class="pre">mps_canonical_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#mps_canonical_right"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.mps_canonical_right" title="Link to this definition"></a></dt>
<dd><p>normalize MPS matrices from the right
treat the last two dimensions as a vector to reduce the left leg numbers
M1 * M2 = M1 * U*s*V^T = (M1*U*s) * V^T
such that M2 is replaced by a smaller V^T</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.zipper_from_left">
<span class="sig-name descname"><span class="pre">zipper_from_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[[1.]]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#zipper_from_left"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_left" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Tl legs order from bottom to top, default np.ones((1,1,1)) for boundary site
Contract Tl from the left with 1). bra Mt at top,</p>
<blockquote>
<div><p>2). operator O at middle,
3). ket Mt at bottom.</p>
</div></blockquote>
<p>/—3—<em>q</em>—1—Mt—3-k–
|                 |
|                 2
|                 |
|                 <em>l
|                 |
|                 3              /—3-k–
|                 |              |
Tl–2—*p</em>—1—O—-2-j– =   Tf–2-j–
|                 |              |
|                 4             \—1-i–
|                 |
|                 <a href="#id9"><span class="problematic" id="id10">*</span></a>m
|                 |
|                 2
|                 |</p>
</div></blockquote>
<p>\—1—<em>n</em>—3—Mb—1-i—</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.matrix_product_state.zipper_from_right">
<span class="sig-name descname"><span class="pre">zipper_from_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">O</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[[1.]]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/matrix_product_state.html#zipper_from_right"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.matrix_product_state.zipper_from_right" title="Link to this definition"></a></dt>
<dd><p>Tr legs order from top to bottom, default np.ones((1,1,1)) for boundary site
Contract Tl from the right with 1). bra Mt at top,</p>
<blockquote>
<div><p>2). operator O at middle,
3). ket Mt at bottom.</p>
</div></blockquote>
<dl>
<dt>–i-1—Mt—3—<em>q</em>—1–\</dt><dd><div class="line-block">
<div class="line"><a href="#id11"><span class="problematic" id="id12">|</span></a></div>
</div>
<p>2                  |
|                  |
<a href="#id13"><span class="problematic" id="id14">*</span></a>l                 |
|                  |
3                  |      –1-i-\
|                  |             |</p>
</dd>
<dt>–j-1—O—-2—<em>p</em>—2—Tr =   –2-j–Tf</dt><dd><div class="line-block">
<div class="line">|             |</div>
</div>
<p>4                  |      –3-k–/
|                  |
<a href="#id15"><span class="problematic" id="id16">*</span></a>m                 |
|                  |
2                  |
|                  |</p>
</dd>
</dl>
<p>–k-3—Mb—1—<em>n</em>—3—/</p>
</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins.spin_hamil">
<span id="wavefunction-analysis-spins-spin-hamil-module"></span><h2>wavefunction_analysis.spins.spin_hamil module<a class="headerlink" href="#module-wavefunction_analysis.spins.spin_hamil" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_prod_spin_list">
<span class="sig-name descname"><span class="pre">get_prod_spin_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_prod_spin_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_prod_spin_list" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>the actual sigma_{ix} matrix:</dt><dd><p>loop over n spins
set i-th spin with spin matrices while the rest are identity matrices
return n*d supermatrices as Hilbert space operators or basis</p>
</dd>
</dl>
<p>the use of these matrices gives exact Hamiltonian in rather huge dimension</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_spin">
<span class="sig-name descname"><span class="pre">get_spin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_spin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_spin" title="Link to this definition"></a></dt>
<dd><p>spin matrices from qutip package</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_spin_mat">
<span class="sig-name descname"><span class="pre">get_spin_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_spin_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_spin_mat" title="Link to this definition"></a></dt>
<dd><p>reload get_spin() but return numpy matrix by qutip full() function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.get_spins">
<span class="sig-name descname"><span class="pre">get_spins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#get_spins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.get_spins" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_heisenberg_1d">
<span class="sig-name descname"><span class="pre">hamil_heisenberg_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_heisenberg_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_heisenberg_1d" title="Link to this definition"></a></dt>
<dd><p>build xxz 1d-chain spin model hamiltonian H in Hilbert space
H = sum_{i}^{n} ( j_{i,x} * sigma_{i,x} sigma_{i+1,x}</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>j_{i,y} * sigma_{i,y} sigma_{i+1,y}</p></li>
<li><p>j_{i,z} * sigma_{i,z} sigma_{i+1,z})</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>sum_{i}^{n} hz_{i} * sigma_{i,z}</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>note that when j_{x} = j_{y}</dt><dd><p>sigma_x sigma_x + sigma_y sigma_y
= .5 * (sigma_p sigma_m + sigma_m sigma_p)
using ladder operators such that the matrices are real</p>
</dd>
</dl>
<p>n: number of 1/2 spins
j: spin coupling constant of xx, yy, zz sigma
hz: magnetic field strength along z axis for each spin
boundary condition: open or periodic</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_x_1d">
<span class="sig-name descname"><span class="pre">hamil_x_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_x_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_x_1d" title="Link to this definition"></a></dt>
<dd><p>separate one direction for efficiency</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_xxz_1d">
<span class="sig-name descname"><span class="pre">hamil_xxz_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_xxz_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_xxz_1d" title="Link to this definition"></a></dt>
<dd><p>j * (xx + yy + zz * delta)
reimplement for efficiency using ladder operator by defalut</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_xyz_1d">
<span class="sig-name descname"><span class="pre">hamil_xyz_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_xyz_1d" title="Link to this definition"></a></dt>
<dd><p>build xxz 1d-chain spin model hamiltonian H in Hilbert space
H = sum_{i}^{n} ( j_{i,x} * sigma_{i,x} sigma_{i+1,x}</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>j_{i,y} * sigma_{i,y} sigma_{i+1,y}</p></li>
<li><p>j_{i,z} * sigma_{i,z} sigma_{i+1,z})</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>sum_{i}^{n} hz_{i} * sigma_{i,z}</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>note that when j_{x} = j_{y}</dt><dd><p>sigma_x sigma_x + sigma_y sigma_y
= .5 * (sigma_p sigma_m + sigma_m sigma_p)
using ladder operators such that the matrices are real</p>
</dd>
</dl>
<p>n: number of 1/2 spins
j: spin coupling constant of xx, yy, zz sigma
hz: magnetic field strength along z axis for each spin
boundary condition: open or periodic</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wavefunction_analysis.spins.spin_hamil.hamil_zeeman_1d">
<span class="sig-name descname"><span class="pre">hamil_zeeman_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wavefunction_analysis/spins/spin_hamil.html#hamil_zeeman_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wavefunction_analysis.spins.spin_hamil.hamil_zeeman_1d" title="Link to this definition"></a></dt>
<dd><p>separate the magnetic field part for efficiency</p>
</dd></dl>

</section>
<section id="module-wavefunction_analysis.spins">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-wavefunction_analysis.spins" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="wavefunction_analysis.quantum_computing.html" class="btn btn-neutral float-left" title="wavefunction_analysis.quantum_computing package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wavefunction_analysis.string_path.html" class="btn btn-neutral float-right" title="wavefunction_analysis.string_path package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Zheng Pei.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>